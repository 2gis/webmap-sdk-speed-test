(function(){"use strict";var te=(t=>(t[t.Main=0]="Main",t[t.Parser=1]="Parser",t[t.Labeling=2]="Labeling",t[t.Models=3]="Models",t[t.All=4]="All",t))(te||{}),R=(t=>(t[t.FunctionUse=0]="FunctionUse",t[t.FunctionResult=1]="FunctionResult",t))(R||{});class xe{constructor(){this.events={}}on(e,r){let i=this.events[e];return i||(i=this.events[e]=[]),i.push(r),this}once(e,r){const i=o=>{this.off(e,i),r.call(this,o)};return this.on(e,i),this}off(e,r){const i=this.events[e];if(!i)return this;const o=i.indexOf(r);return o!==-1&&i.splice(o,1),this}emit(e,r){const i=this.events[e];if(!i)return this;const o=i.slice();for(let a=0;a<o.length;a++)o[a].call(this,r);return this}}class we extends xe{constructor(e){super(),this.worker=e,e.addEventListener("message",r=>{const i=r.data;this.emit("message",i)})}send(e,r,i){const o={to:e,msg:r,transferable:i};this.worker.postMessage(o,i)}broadcast(e){const r={to:te.All,msg:e};this.worker.postMessage(r)}}class pe{constructor(e){this.onMessage=r=>{const{from:i,msg:o}=r;switch(o.type){case R.FunctionUse:this.onFunctionUse(o,i);break;case R.FunctionResult:this.onFunctionResult(o);break}},this.connector=e,this.functions=new Map,this.functionIdCounter=0,this.pendingFunctions=new Map,e.on("message",this.onMessage)}set(e,r){this.functions.set(e,r)}get(e,r){return(...i)=>{const o=this.functionIdCounter++,a=new Promise(c=>{this.pendingFunctions.set(o,c)}),f={type:R.FunctionUse,data:{id:o,name:r,args:i}};return this.connector.send(e,f),a}}onFunctionUse(e,r){const{data:{name:i,args:o,id:a}}=e,f=this.functions.get(i);if(f){const c=f(...o);c&&c.then?Promise.resolve(c).then(l=>this.sendFunctionResult(r,a,l)):this.sendFunctionResult(r,a,c)}else console.error(`FnRegistry#onFunctionUse: function ${i} not found`)}sendFunctionResult(e,r,i){const o={type:R.FunctionResult,data:{id:r,result:i}};i&&i.transferable?this.connector.send(e,o,i.transferable):this.connector.send(e,o)}onFunctionResult(e){const{data:{id:r,result:i}}=e,o=this.pendingFunctions.get(r);o?(o(i),this.pendingFunctions.delete(r)):console.error(`FnRegistry#onFunctionResult: pending function ${r} not found`)}}class ye{constructor(e){this.fnRegistry=e,this.onClassCreate=({id:r,name:i,args:o})=>{const a=this.classes.get(i);if(!a){console.error(`ClassRegistry#onClassCreate: class ${i} not found`);return}const f=a.scope?new a.ClassConstructor(a.scope,...o):new a.ClassConstructor(...o);a.hosts.set(r,f)},this.onMethodUse=({id:r,name:i,method:o,args:a})=>{const f=this.classes.get(i);if(!f){console.error(`ClassRegistry#onMethodUse: class ${i} not found`);return}const c=f.hosts.get(r);if(!c){console.error(`ClassRegistry#onMethodUse: instance ${r} in class ${i} not found when calling the ${o} method`);return}if(!c[o]){console.error(`ClassRegistry#onMethodUse: method ${o} in instance ${r} in class ${i} not found`);return}return o==="destroy"&&f.hosts.delete(r),c[o](...a)},this.classes=new Map,this.idCounter=0,this.fnRegistry.set("createClass",this.onClassCreate),this.fnRegistry.set("classMethodUse",this.onMethodUse)}set(e,r,i){const o=this,a={ClassConstructor:r,hosts:new Map,proxies:new Map,scope:i};return this.classes.set(e,a),{get:f=>{class c{constructor(...x){this.id=o.idCounter++,o.fnRegistry.get(f,"createClass")({id:this.id,args:x,name:e})}}return Object.getOwnPropertyNames(r.prototype).forEach(h=>{h!=="constructor"&&(c.prototype[h]=function(...x){return o.fnRegistry.get(f,"classMethodUse")({id:this.id,name:e,method:h,args:x})})}),c}}}}let k=typeof Float64Array<"u"?Float64Array:Array;function P(){let t=new k(3);return t[0]=0,t[1]=0,t[2]=0,t}function ge(t){let e=t[0],r=t[1],i=t[2];return Math.sqrt(e*e+r*r+i*i)}function D(t,e,r){let i=new k(3);return i[0]=t,i[1]=e,i[2]=r,i}function Fe(t,e){let r=e[0],i=e[1],o=e[2],a=r*r+i*i+o*o;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t}function Te(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function W(t,e,r){let i=e[0],o=e[1],a=e[2],f=r[0],c=r[1],l=r[2];return t[0]=o*l-a*c,t[1]=a*f-i*l,t[2]=i*c-o*f,t}const Ae=ge;(function(){let t=P();return function(e,r,i,o,a,f){let c,l;for(r||(r=3),i||(i=0),o?l=Math.min(o*r+i,e.length):l=e.length,c=i;c<l;c+=r)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],a(t,t,f),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2];return e}})();function J(){let t=new k(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Ie(t,e,r,i){let o=new k(4);return o[0]=t,o[1]=e,o[2]=r,o[3]=i,o}function be(t,e){let r=e[0],i=e[1],o=e[2],a=e[3],f=r*r+i*i+o*o+a*a;return f>0&&(f=1/Math.sqrt(f),t[0]=r*f,t[1]=i*f,t[2]=o*f,t[3]=a*f),t}(function(){let t=J();return function(e,r,i,o,a,f){let c,l;for(r||(r=4),i||(i=0),o?l=Math.min(o*r+i,e.length):l=e.length,c=i;c<l;c+=r)t[0]=e[c],t[1]=e[c+1],t[2]=e[c+2],t[3]=e[c+3],a(t,t,f),e[c]=t[0],e[c+1]=t[1],e[c+2]=t[2],e[c+3]=t[3];return e}})();function ve(t,e,r,i,o,a,f,c,l,h,x,d,g,F,v,B){let T=new k(16);return T[0]=t,T[1]=e,T[2]=r,T[3]=i,T[4]=o,T[5]=a,T[6]=f,T[7]=c,T[8]=l,T[9]=h,T[10]=x,T[11]=d,T[12]=g,T[13]=F,T[14]=v,T[15]=B,T}function ne(t,e,r){return t[0]=r[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=r[2],t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function Be(t,e){return{path:e,extensions:t.extensions,extensionsRequired:t.extensionsRequired??[],extensionsUsed:t.extensionsUsed??[],extras:t.extras,accessors:me(t.accessors),buffers:Ve(t.buffers),bufferViews:Se(t.bufferViews),cameras:Ce(t.cameras),scene:t.scene??0,scenes:Re(t.scenes),nodes:_e(t.nodes),materials:Ee(t.materials),meshes:Ue(t.meshes),asset:Me(t.asset),animations:ke(t.animations),images:Pe(t.images),textures:De(t.textures),samplers:Oe(t.samplers),skins:Ne(t.skins)}}function Me(t){return{copyright:t.copyright,generator:t.generator,version:t.version,minVersion:t.minVersion}}function me(t=[]){return t.map(e=>({bufferView:e.bufferView,byteOffset:e.byteOffset??0,componentType:e.componentType,normalized:e.normalized,count:e.count,type:e.type,max:e.max,min:e.min,sparse:e.sparse,name:e.name,extensions:e.extensions,extras:e.extras}))}function ke(t=[]){return t.map(e=>({channels:e.channels,samplers:e.samplers,name:e.name,extensions:e.extensions,extras:e.extras}))}function Ve(t=[]){return t.map(e=>({uri:e.uri,byteLength:e.byteLength,name:e.name,extensions:e.extensions,extras:e.extras,buffer:void 0}))}function Se(t=[]){return t.map(e=>({buffer:e.buffer,byteOffset:e.byteOffset,byteLength:e.byteLength,byteStride:e.byteStride,target:e.target,name:e.name,extensions:e.extensions,extras:e.extras}))}function Ce(t=[]){return t.map(e=>({type:e.type,orthographic:e.orthographic,perspective:e.perspective,name:e.name,extensions:e.extensions,extras:e.extras}))}function Ue(t=[]){return t.map(e=>({primitives:e.primitives,name:e.name,weights:e.weights,extensions:e.extensions,extras:e.extras}))}function Ee(t=[]){return t.map(e=>({alphaCutoff:e.alphaCutoff,alphaMode:e.alphaMode,doubleSided:e.doubleSided,emissiveFactor:e.emissiveFactor,emissiveTexture:e.emissiveTexture,normalTexture:e.normalTexture,occlusionTexture:e.occlusionTexture,pbrMetallicRoughness:e.pbrMetallicRoughness,name:e.name,extras:e.extras,extensions:e.extensions}))}function Re(t=[]){return t.map(e=>({nodes:e.nodes,extensions:e.extensions,extras:e.extras,name:e.name}))}function _e(t=[]){return t.map(e=>{const r=e.rotation??[0,0,0,1],i=e.scale??[1,1,1],o=e.translation??[0,0,0];return{camera:e.camera,children:e.children,matrix:e.matrix?ve(...e.matrix):void 0,rotation:Ie(...r),scale:D(...i),translation:D(...o),name:e.name,mesh:e.mesh,skin:e.skin,extras:e.extras,extensions:e.extensions}})}function Pe(t=[]){return t.map(e=>({bufferView:e.bufferView,mimeType:e.mimeType,name:e.name,uri:e.uri,extensions:e.extensions,extras:e.extras,image:void 0}))}function De(t=[]){return t.map(e=>({extensions:e.extensions,extras:e.extras,name:e.name,sampler:e.sampler,source:e.source}))}function Oe(t=[]){return t.map(e=>({extensions:e.extensions,extras:e.extras,name:e.name,magFilter:e.magFilter,minFilter:e.minFilter,wrapS:e.wrapS,wrapT:e.wrapT}))}function Ne(t=[]){return t.map(e=>({joints:e.joints,extensions:e.extensions,extras:e.extras,inverseBindMatrices:e.inverseBindMatrices,name:e.name,skeleton:e.skeleton}))}const _={JPEG:"image/jpeg",PNG:"image/png",GLTEXTURE:"image/texture"};function re(t){return t.substring(0,t.lastIndexOf("/")+1)}function Le(t){if(t.startsWith("data:image"))return t.split(";")[0].split(":")[1];switch(t.substring(t.lastIndexOf("."))){case".png":return _.PNG;case".jpg":case".jpeg":default:return _.JPEG}}function ie(t){const e=atob(t.split(",")[1]),r=new ArrayBuffer(e.length),i=new Uint8Array(r);for(let o=0;o<e.length;o++)i[o]=e.charCodeAt(o);return r}const I=class I{constructor(e){this.data=e}static isGlb(e){const r=new Uint32Array(e,0,I.glbHeaderInts),i=r[0],o=r[1];return i===this.glbMagic&&o===this.glbVersion}extractGlbData(){if(this.getCheckedGlbInfo()===void 0)return{json:j,buffers:[]};let r;const i=[],o=this.getAllChunkInfos();for(const a of o)a.type===I.jsonChunkType&&!r?r=this.getJsonFromChunk(a):a.type===I.binaryChunkType&&i.push(this.getBufferFromChunk(a));return{json:r||j,buffers:i}}getCheckedGlbInfo(){const e=new Uint32Array(this.data,0,I.glbHeaderInts),r=e[0],i=e[1],o=e[2];if(!(!this.checkEquality(r,I.glbMagic,"glb magic")||!this.checkEquality(i,I.glbVersion,"glb header version")||!this.checkEquality(o,this.data.byteLength,"glb byte length")))return{magic:r,version:i,length:o}}getAllChunkInfos(){const e=[];let r=I.glbHeaderInts*4;for(;r<this.data.byteLength;){const i=this.getChunkInfo(r);e.push(i),r+=i.length+I.glbChunkHeaderInts*4}return e}getChunkInfo(e){const r=new Uint32Array(this.data,e,I.glbChunkHeaderInts),i=e+I.glbChunkHeaderInts*4,o=r[0],a=r[1];return{start:i,length:o,type:a}}getJsonFromChunk(e){const r=e.length,i=(I.glbHeaderInts+I.glbChunkHeaderInts)*4,o=new Uint8Array(this.data,i,r),a=new TextDecoder("utf-8").decode(o);return JSON.parse(a)}getBufferFromChunk(e){return this.data.slice(e.start,e.start+e.length)}checkEquality(e,r,i){return e===r?!0:(console.error(`[GLB MODEL PARSING ERROR] Found invalid/unsupported ${i}, expected: ${r}, but was: ${e}`),!1)}};I.glbHeaderInts=3,I.glbChunkHeaderInts=2,I.glbMagic=1179937895,I.glbVersion=2,I.jsonChunkType=1313821514,I.binaryChunkType=5130562;let O=I;const se=5120,Ge=5121,$e=5122,He=5123,ze=5124,oe=5125,We=5126,Je=4;let q;function qe(t){q=Ye(t).then(e=>e).catch(e=>{const r="Draco decoder module failed to initialize"+(e!=null&&e.message?` with the following error: ${e.message}`:".");throw new Error(r)})}async function Xe(t){let e=await fetch(t).then(o=>o.text());const i=e.indexOf("if (typeof exports === 'object' && typeof module === 'object')");return i!==0&&(e=e.slice(0,i),e=e+"return DracoDecoderModule;"),e}async function Ye(t){const e=await Xe(t);return new Function(e)()()}function Ke(t){switch(t){case se:return"Int8Array";case Ge:return"Uint8Array";case $e:return"Int16Array";case He:return"Uint16Array";case ze:return"Int32Array";case oe:return"Uint32Array";case We:return"Float32Array";default:return"Float32Array"}}function Qe(t,e,r,i,o,a){const f=o.num_components(),l=r.num_points()*f;let h,x,d;switch(a){case"Float32Array":d=l*4,h=t._malloc(d),e.GetAttributeDataArrayForAllPoints(r,o,t.DT_FLOAT32,d,h),x=new Float32Array(t.HEAPF32.buffer,h,l).slice(),t._free(h);break;case"Int8Array":h=t._malloc(l),e.GetAttributeDataArrayForAllPoints(r,o,t.DT_INT8,l,h),x=new Int8Array(t.HEAP8.buffer,h,l).slice(),t._free(h);break;case"Int16Array":d=l*2,h=t._malloc(d),e.GetAttributeDataArrayForAllPoints(r,o,t.DT_INT16,d,h),x=new Int16Array(t.HEAP16.buffer,h,l).slice(),t._free(h);break;case"Int32Array":d=l*4,h=t._malloc(d),e.GetAttributeDataArrayForAllPoints(r,o,t.DT_INT32,d,h),x=new Int32Array(t.HEAP32.buffer,h,l).slice(),t._free(h);break;case"Uint8Array":h=t._malloc(l),e.GetAttributeDataArrayForAllPoints(r,o,t.DT_UINT8,l,h),x=new Uint8Array(t.HEAPU8.buffer,h,l).slice(),t._free(h);break;case"Uint16Array":d=l*2,h=t._malloc(d),e.GetAttributeDataArrayForAllPoints(r,o,t.DT_UINT16,d,h),x=new Uint16Array(t.HEAPU16.buffer,h,l).slice(),t._free(h);break;case"Uint32Array":d=l*4,h=t._malloc(d),e.GetAttributeDataArrayForAllPoints(r,o,t.DT_UINT32,d,h),x=new Uint32Array(t.HEAPU32.buffer,h,l).slice(),t._free(h);break;default:throw new Error("DRACOLoader: Unexpected attribute type.")}return{name:i,array:x,itemSize:f,componentType:a}}function Ze(t,e,r,i,o,a){let f,c;const l=e.GetEncodedGeometryType(r);if(l===t.TRIANGULAR_MESH)f=new t.Mesh,c=e.DecodeBufferToMesh(r,f);else throw new Error("DRACOLoader: Unexpected geometry type.");if(!c.ok()||f.ptr===0)throw new Error("DRACOLoader: Decoding failed: "+c.error_msg());const h={index:null,attributes:{}},x=f.num_points();for(const d in i){let g=se,F;for(const[T,H]of Object.entries(a))if(T===d){g=o.accessors[H].componentType,F=o.accessors[H].count;break}if(x!==F)throw new Error(`DRACOLoader: Accessor vertex count ${F} does not match draco decoder vertex count  ${x}`);g=Ke(g);const v=e.GetAttributeByUniqueId(f,i[d]),B=Qe(t,e,f,d,v,g);h.attributes[B.name]=B}if(l===t.TRIANGULAR_MESH){const g=f.num_faces()*3,F=g*4,v=t._malloc(F);e.GetTrianglesUInt32Array(f,F,v);const B=new Uint32Array(t.HEAPU32.buffer,v,g).slice();t._free(v),h.index={array:B,itemSize:1}}return t.destroy(f),h}function je(t,e,r,i){const o=t.bufferView,a=e.bufferViews[o],f=e.buffers[a.buffer],l=new Int8Array(f.buffer).slice(a.byteOffset,a.byteOffset+a.byteLength),h=new r.Decoder,x=new r.DecoderBuffer;x.Init(l,a.byteLength);const d=Ze(r,h,x,t.attributes,e,i);return r.destroy(x),d}function m(t,e,r,i,o){const a={buffer:t,byteLength:t.byteLength,extensions:void 0,extras:void 0,name:void 0,uri:void 0};e.buffers.push(a);const f={buffer:e.buffers.length-1,byteLength:t.byteLength,byteOffset:0,byteStride:0,extensions:void 0,extras:void 0,name:o,target:i};e.bufferViews.push(f),e.accessors[r].byteOffset=0,e.accessors[r].bufferView=e.bufferViews.length-1}function V(t,e){let r;switch(e){case"Int8Array":r=new ArrayBuffer(t.length),new Int8Array(r).set(t);break;case"Uint8Array":r=new ArrayBuffer(t.length),new Uint8Array(r).set(t);break;case"Int16Array":r=new ArrayBuffer(t.length*2),new Int16Array(r).set(t);break;case"Uint16Array":r=new ArrayBuffer(t.length*2),new Uint16Array(r).set(t);break;case"Int32Array":r=new ArrayBuffer(t.length*4),new Int32Array(r).set(t);break;case"Uint32Array":r=new ArrayBuffer(t.length*4),new Uint32Array(r).set(t);break;default:case"Float32Array":r=new ArrayBuffer(t.length*4),new Float32Array(r).set(t);break}return r}function et(t,e,r,i){const o=e.index.array;if(i!==void 0&&(m(o,t,i,34963,"index buffer view"),t.accessors[i].componentType=oe),e.attributes.POSITION!==void 0){const a=V(e.attributes.POSITION.array,e.attributes.POSITION.componentType);m(a,t,r.POSITION,34962,"position buffer view")}if(e.attributes.NORMAL!==void 0){const a=V(e.attributes.NORMAL.array,e.attributes.NORMAL.componentType);m(a,t,r.NORMAL,34962,"normal buffer view")}for(let a=0;a<Je;++a){const f=`TEXCOORD_${a}`;if(e.attributes[f]!==void 0){const c=V(e.attributes[f].array,e.attributes[f].componentType);m(c,t,r[f],34962,`${f} buffer view`)}}if(e.attributes.TANGENT!==void 0){const a=V(e.attributes.TANGENT.array,e.attributes.TANGENT.componentType);m(a,t,r.TANGENT,34962,"Tangent buffer view")}if(e.attributes.COLOR_0!==void 0){const a=V(e.attributes.COLOR_0.array,e.attributes.COLOR_0.componentType);m(a,t,r.COLOR_0,34962,"color buffer view")}if(e.attributes.JOINTS_0!==void 0){const a=V(e.attributes.JOINTS_0.array,e.attributes.JOINTS_0.componentType);m(a,t,r.JOINTS_0,34963,"JOINTS_0 buffer view")}if(e.attributes.WEIGHTS_0!==void 0){const a=V(e.attributes.WEIGHTS_0.array,e.attributes.WEIGHTS_0.componentType);m(a,t,r.WEIGHTS_0,34963,"WEIGHTS_0 buffer view")}if(e.attributes.JOINTS_1!==void 0){const a=V(e.attributes.JOINTS_1.array,e.attributes.JOINTS_1.componentType);m(a,t,r.JOINTS_1,34963,"JOINTS_1 buffer view")}if(e.attributes.WEIGHTS_1!==void 0){const a=V(e.attributes.WEIGHTS_1.array,e.attributes.WEIGHTS_1.componentType);m(a,t,r.WEIGHTS_1,34963,"WEIGHTS_1 buffer view")}}async function tt(t,e){var r;if(!Array.isArray(t.meshes))return Promise.resolve();for(const i of t.meshes)if(Array.isArray(i.primitives))for(const o of i.primitives){if(((r=o.extensions)==null?void 0:r.KHR_draco_mesh_compression)===void 0)continue;q||qe(e);const a=await q;if(!a)continue;const f=je(o.extensions.KHR_draco_mesh_compression,t,a,o.attributes);et(t,f,o.attributes,o.indices)}}const N=2**32;function nt(t,e){const r=new URL(e);return t.startsWith("//")?`${r.protocol}${t}`:t.startsWith("/")?`${r.origin}${t}`:t}function X(){let t=new k(2);return t[0]=0,t[1]=0,t}function ae(t,e){let r=new k(2);return r[0]=t,r[1]=e,r}(function(){let t=X();return function(e,r,i,o,a,f){let c,l;for(r||(r=2),i||(i=0),o?l=Math.min(o*r+i,e.length):l=e.length,c=i;c<l;c+=r)t[0]=e[c],t[1]=e[c+1],a(t,t,f),e[c]=t[0],e[c+1]=t[1];return e}})();var L={},ue;function rt(){return ue||(ue=1,function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",e=new Uint8Array(256),r=0;r<t.length;r++)e[t.charCodeAt(r)]=r;L.encode=function(i){var o=new Uint8Array(i),a,f=o.length,c="";for(a=0;a<f;a+=3)c+=t[o[a]>>2],c+=t[(o[a]&3)<<4|o[a+1]>>4],c+=t[(o[a+1]&15)<<2|o[a+2]>>6],c+=t[o[a+2]&63];return f%3===2?c=c.substring(0,c.length-1)+"=":f%3===1&&(c=c.substring(0,c.length-2)+"=="),c},L.decode=function(i){var o=i.length*.75,a=i.length,f,c=0,l,h,x,d;i[i.length-1]==="="&&(o--,i[i.length-2]==="="&&o--);var g=new ArrayBuffer(o),F=new Uint8Array(g);for(f=0;f<a;f+=4)l=e[i.charCodeAt(f)],h=e[i.charCodeAt(f+1)],x=e[i.charCodeAt(f+2)],d=e[i.charCodeAt(f+3)],F[c++]=l<<2|h>>4,F[c++]=(h&15)<<4|x>>2,F[c++]=(x&3)<<6|d&63;return g}}()),L}rt();var G={},fe;function it(){return fe||(fe=1,G.read=function(t,e,r,i,o){var a,f,c=o*8-i-1,l=(1<<c)-1,h=l>>1,x=-7,d=r?o-1:0,g=r?-1:1,F=t[e+d];for(d+=g,a=F&(1<<-x)-1,F>>=-x,x+=c;x>0;a=a*256+t[e+d],d+=g,x-=8);for(f=a&(1<<-x)-1,a>>=-x,x+=i;x>0;f=f*256+t[e+d],d+=g,x-=8);if(a===0)a=1-h;else{if(a===l)return f?NaN:(F?-1:1)*(1/0);f=f+Math.pow(2,i),a=a-h}return(F?-1:1)*f*Math.pow(2,a-i)},G.write=function(t,e,r,i,o,a){var f,c,l,h=a*8-o-1,x=(1<<h)-1,d=x>>1,g=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,F=i?0:a-1,v=i?1:-1,B=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(c=isNaN(e)?1:0,f=x):(f=Math.floor(Math.log(e)/Math.LN2),e*(l=Math.pow(2,-f))<1&&(f--,l*=2),f+d>=1?e+=g/l:e+=g*Math.pow(2,1-d),e*l>=2&&(f++,l/=2),f+d>=x?(c=0,f=x):f+d>=1?(c=(e*l-1)*Math.pow(2,o),f=f+d):(c=e*Math.pow(2,d-1)*Math.pow(2,o),f=0));o>=8;t[r+F]=c&255,F+=v,c/=256,o-=8);for(f=f<<o|c,h+=o;h>0;t[r+F]=f&255,F+=v,f/=256,h-=8);t[r+F-v]|=B*128}),G}var Y,ce;function st(){if(ce)return Y;ce=1,Y=e;var t=it();function e(n){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(n)?n:new Uint8Array(n||0),this.pos=0,this.type=0,this.length=this.buf.length}e.Varint=0,e.Fixed64=1,e.Bytes=2,e.Fixed32=5;var r=65536*65536,i=1/r,o=12,a=typeof TextDecoder>"u"?null:new TextDecoder("utf8");e.prototype={destroy:function(){this.buf=null},readFields:function(n,s,u){for(u=u||this.length;this.pos<u;){var p=this.readVarint(),w=p>>3,y=this.pos;this.type=p&7,n(w,s,this),this.pos===y&&this.skip(p)}return s},readMessage:function(n,s){return this.readFields(n,s,this.readVarint()+this.pos)},readFixed32:function(){var n=z(this.buf,this.pos);return this.pos+=4,n},readSFixed32:function(){var n=de(this.buf,this.pos);return this.pos+=4,n},readFixed64:function(){var n=z(this.buf,this.pos)+z(this.buf,this.pos+4)*r;return this.pos+=8,n},readSFixed64:function(){var n=z(this.buf,this.pos)+de(this.buf,this.pos+4)*r;return this.pos+=8,n},readFloat:function(){var n=t.read(this.buf,this.pos,!0,23,4);return this.pos+=4,n},readDouble:function(){var n=t.read(this.buf,this.pos,!0,52,8);return this.pos+=8,n},readVarint:function(n){var s=this.buf,u,p;return p=s[this.pos++],u=p&127,p<128||(p=s[this.pos++],u|=(p&127)<<7,p<128)||(p=s[this.pos++],u|=(p&127)<<14,p<128)||(p=s[this.pos++],u|=(p&127)<<21,p<128)?u:(p=s[this.pos],u|=(p&15)<<28,f(u,n,this))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var n=this.readVarint();return n%2===1?(n+1)/-2:n/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var n=this.readVarint()+this.pos,s=this.pos;return this.pos=n,n-s>=o&&a?bt(this.buf,s,n):It(this.buf,s,n)},readBytes:function(){var n=this.readVarint()+this.pos,s=this.buf.subarray(this.pos,n);return this.pos=n,s},readPackedVarint:function(n,s){if(this.type!==e.Bytes)return n.push(this.readVarint(s));var u=c(this);for(n=n||[];this.pos<u;)n.push(this.readVarint(s));return n},readPackedSVarint:function(n){if(this.type!==e.Bytes)return n.push(this.readSVarint());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readSVarint());return n},readPackedBoolean:function(n){if(this.type!==e.Bytes)return n.push(this.readBoolean());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readBoolean());return n},readPackedFloat:function(n){if(this.type!==e.Bytes)return n.push(this.readFloat());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readFloat());return n},readPackedDouble:function(n){if(this.type!==e.Bytes)return n.push(this.readDouble());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readDouble());return n},readPackedFixed32:function(n){if(this.type!==e.Bytes)return n.push(this.readFixed32());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readFixed32());return n},readPackedSFixed32:function(n){if(this.type!==e.Bytes)return n.push(this.readSFixed32());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readSFixed32());return n},readPackedFixed64:function(n){if(this.type!==e.Bytes)return n.push(this.readFixed64());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readFixed64());return n},readPackedSFixed64:function(n){if(this.type!==e.Bytes)return n.push(this.readSFixed64());var s=c(this);for(n=n||[];this.pos<s;)n.push(this.readSFixed64());return n},skip:function(n){var s=n&7;if(s===e.Varint)for(;this.buf[this.pos++]>127;);else if(s===e.Bytes)this.pos=this.readVarint()+this.pos;else if(s===e.Fixed32)this.pos+=4;else if(s===e.Fixed64)this.pos+=8;else throw new Error("Unimplemented type: "+s)},writeTag:function(n,s){this.writeVarint(n<<3|s)},realloc:function(n){for(var s=this.length||16;s<this.pos+n;)s*=2;if(s!==this.length){var u=new Uint8Array(s);u.set(this.buf),this.buf=u,this.length=s}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(n){this.realloc(4),U(this.buf,n,this.pos),this.pos+=4},writeSFixed32:function(n){this.realloc(4),U(this.buf,n,this.pos),this.pos+=4},writeFixed64:function(n){this.realloc(8),U(this.buf,n&-1,this.pos),U(this.buf,Math.floor(n*i),this.pos+4),this.pos+=8},writeSFixed64:function(n){this.realloc(8),U(this.buf,n&-1,this.pos),U(this.buf,Math.floor(n*i),this.pos+4),this.pos+=8},writeVarint:function(n){if(n=+n||0,n>268435455||n<0){h(n,this);return}this.realloc(4),this.buf[this.pos++]=n&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=(n>>>=7)&127|(n>127?128:0),!(n<=127)&&(this.buf[this.pos++]=n>>>7&127)))},writeSVarint:function(n){this.writeVarint(n<0?-n*2-1:n*2)},writeBoolean:function(n){this.writeVarint(!!n)},writeString:function(n){n=String(n),this.realloc(n.length*4),this.pos++;var s=this.pos;this.pos=vt(this.buf,n,this.pos);var u=this.pos-s;u>=128&&g(s,u,this),this.pos=s-1,this.writeVarint(u),this.pos+=u},writeFloat:function(n){this.realloc(4),t.write(this.buf,n,this.pos,!0,23,4),this.pos+=4},writeDouble:function(n){this.realloc(8),t.write(this.buf,n,this.pos,!0,52,8),this.pos+=8},writeBytes:function(n){var s=n.length;this.writeVarint(s),this.realloc(s);for(var u=0;u<s;u++)this.buf[this.pos++]=n[u]},writeRawMessage:function(n,s){this.pos++;var u=this.pos;n(s,this);var p=this.pos-u;p>=128&&g(u,p,this),this.pos=u-1,this.writeVarint(p),this.pos+=p},writeMessage:function(n,s,u){this.writeTag(n,e.Bytes),this.writeRawMessage(s,u)},writePackedVarint:function(n,s){s.length&&this.writeMessage(n,F,s)},writePackedSVarint:function(n,s){s.length&&this.writeMessage(n,v,s)},writePackedBoolean:function(n,s){s.length&&this.writeMessage(n,H,s)},writePackedFloat:function(n,s){s.length&&this.writeMessage(n,B,s)},writePackedDouble:function(n,s){s.length&&this.writeMessage(n,T,s)},writePackedFixed32:function(n,s){s.length&&this.writeMessage(n,gt,s)},writePackedSFixed32:function(n,s){s.length&&this.writeMessage(n,Ft,s)},writePackedFixed64:function(n,s){s.length&&this.writeMessage(n,Tt,s)},writePackedSFixed64:function(n,s){s.length&&this.writeMessage(n,At,s)},writeBytesField:function(n,s){this.writeTag(n,e.Bytes),this.writeBytes(s)},writeFixed32Field:function(n,s){this.writeTag(n,e.Fixed32),this.writeFixed32(s)},writeSFixed32Field:function(n,s){this.writeTag(n,e.Fixed32),this.writeSFixed32(s)},writeFixed64Field:function(n,s){this.writeTag(n,e.Fixed64),this.writeFixed64(s)},writeSFixed64Field:function(n,s){this.writeTag(n,e.Fixed64),this.writeSFixed64(s)},writeVarintField:function(n,s){this.writeTag(n,e.Varint),this.writeVarint(s)},writeSVarintField:function(n,s){this.writeTag(n,e.Varint),this.writeSVarint(s)},writeStringField:function(n,s){this.writeTag(n,e.Bytes),this.writeString(s)},writeFloatField:function(n,s){this.writeTag(n,e.Fixed32),this.writeFloat(s)},writeDoubleField:function(n,s){this.writeTag(n,e.Fixed64),this.writeDouble(s)},writeBooleanField:function(n,s){this.writeVarintField(n,!!s)}};function f(n,s,u){var p=u.buf,w,y;if(y=p[u.pos++],w=(y&112)>>4,y<128||(y=p[u.pos++],w|=(y&127)<<3,y<128)||(y=p[u.pos++],w|=(y&127)<<10,y<128)||(y=p[u.pos++],w|=(y&127)<<17,y<128)||(y=p[u.pos++],w|=(y&127)<<24,y<128)||(y=p[u.pos++],w|=(y&1)<<31,y<128))return l(n,w,s);throw new Error("Expected varint not more than 10 bytes")}function c(n){return n.type===e.Bytes?n.readVarint()+n.pos:n.pos+1}function l(n,s,u){return u?s*4294967296+(n>>>0):(s>>>0)*4294967296+(n>>>0)}function h(n,s){var u,p;if(n>=0?(u=n%4294967296|0,p=n/4294967296|0):(u=~(-n%4294967296),p=~(-n/4294967296),u^4294967295?u=u+1|0:(u=0,p=p+1|0)),n>=18446744073709552e3||n<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");s.realloc(10),x(u,p,s),d(p,s)}function x(n,s,u){u.buf[u.pos++]=n&127|128,n>>>=7,u.buf[u.pos++]=n&127|128,n>>>=7,u.buf[u.pos++]=n&127|128,n>>>=7,u.buf[u.pos++]=n&127|128,n>>>=7,u.buf[u.pos]=n&127}function d(n,s){var u=(n&7)<<4;s.buf[s.pos++]|=u|((n>>>=3)?128:0),n&&(s.buf[s.pos++]=n&127|((n>>>=7)?128:0),n&&(s.buf[s.pos++]=n&127|((n>>>=7)?128:0),n&&(s.buf[s.pos++]=n&127|((n>>>=7)?128:0),n&&(s.buf[s.pos++]=n&127|((n>>>=7)?128:0),n&&(s.buf[s.pos++]=n&127)))))}function g(n,s,u){var p=s<=16383?1:s<=2097151?2:s<=268435455?3:Math.floor(Math.log(s)/(Math.LN2*7));u.realloc(p);for(var w=u.pos-1;w>=n;w--)u.buf[w+p]=u.buf[w]}function F(n,s){for(var u=0;u<n.length;u++)s.writeVarint(n[u])}function v(n,s){for(var u=0;u<n.length;u++)s.writeSVarint(n[u])}function B(n,s){for(var u=0;u<n.length;u++)s.writeFloat(n[u])}function T(n,s){for(var u=0;u<n.length;u++)s.writeDouble(n[u])}function H(n,s){for(var u=0;u<n.length;u++)s.writeBoolean(n[u])}function gt(n,s){for(var u=0;u<n.length;u++)s.writeFixed32(n[u])}function Ft(n,s){for(var u=0;u<n.length;u++)s.writeSFixed32(n[u])}function Tt(n,s){for(var u=0;u<n.length;u++)s.writeFixed64(n[u])}function At(n,s){for(var u=0;u<n.length;u++)s.writeSFixed64(n[u])}function z(n,s){return(n[s]|n[s+1]<<8|n[s+2]<<16)+n[s+3]*16777216}function U(n,s,u){n[u]=s,n[u+1]=s>>>8,n[u+2]=s>>>16,n[u+3]=s>>>24}function de(n,s){return(n[s]|n[s+1]<<8|n[s+2]<<16)+(n[s+3]<<24)}function It(n,s,u){for(var p="",w=s;w<u;){var y=n[w],A=null,C=y>239?4:y>223?3:y>191?2:1;if(w+C>u)break;var S,E,ee;C===1?y<128&&(A=y):C===2?(S=n[w+1],(S&192)===128&&(A=(y&31)<<6|S&63,A<=127&&(A=null))):C===3?(S=n[w+1],E=n[w+2],(S&192)===128&&(E&192)===128&&(A=(y&15)<<12|(S&63)<<6|E&63,(A<=2047||A>=55296&&A<=57343)&&(A=null))):C===4&&(S=n[w+1],E=n[w+2],ee=n[w+3],(S&192)===128&&(E&192)===128&&(ee&192)===128&&(A=(y&15)<<18|(S&63)<<12|(E&63)<<6|ee&63,(A<=65535||A>=1114112)&&(A=null))),A===null?(A=65533,C=1):A>65535&&(A-=65536,p+=String.fromCharCode(A>>>10&1023|55296),A=56320|A&1023),p+=String.fromCharCode(A),w+=C}return p}function bt(n,s,u){return a.decode(n.subarray(s,u))}function vt(n,s,u){for(var p=0,w,y;p<s.length;p++){if(w=s.charCodeAt(p),w>55295&&w<57344)if(y)if(w<56320){n[u++]=239,n[u++]=191,n[u++]=189,y=w;continue}else w=y-55296<<10|w-56320|65536,y=null;else{w>56319||p+1===s.length?(n[u++]=239,n[u++]=191,n[u++]=189):y=w;continue}else y&&(n[u++]=239,n[u++]=191,n[u++]=189,y=null);w<128?n[u++]=w:(w<2048?n[u++]=w>>6|192:(w<65536?n[u++]=w>>12|224:(n[u++]=w>>18|240,n[u++]=w>>12&63|128),n[u++]=w>>6&63|128),n[u++]=w&63|128)}return u}return Y}st(),J(),J();function $(t,e){return{min:t||ae(1/0,1/0),max:e||ae(-1/0,-1/0)}}ne([],[-1,-1,0],[2,2,1]),ne([],[.5,.5,0],[.5,.5,1]),$([-2147483648,-2147483648],[N/2,N/2]),$([-214748364800,-2147483648],[N*100/2,N/2]),X(),X(),P(),Array(16),$(),$();var M={};M.read=function(t,e){return t.readFields(M._readField,{tiles:[]},e)},M._readField=function(t,e,r){t===1&&e.tiles.push(M.Tile.read(r,r.readVarint()+r.pos))},M.write=function(t,e){if(t.tiles)for(var r=0;r<t.tiles.length;r++)e.writeMessage(1,M.Tile.write,t.tiles[r])},M.Tile={},M.Tile.read=function(t,e){return t.readFields(M.Tile._readField,{x:0,y:0,zoom:0},e)},M.Tile._readField=function(t,e,r){t===1?e.x=r.readVarint():t===2?e.y=r.readVarint():t===3&&(e.zoom=r.readVarint())},M.Tile.write=function(t,e){t.x&&e.writeVarintField(1,t.x),t.y&&e.writeVarintField(2,t.y),t.zoom&&e.writeVarintField(3,t.zoom)};var b={};b.read=function(t,e){return t.readFields(b._readField,{tileGroups:[]},e)},b._readField=function(t,e,r){t===1&&e.tileGroups.push(b.TileGroup.read(r,r.readVarint()+r.pos))},b.write=function(t,e){if(t.tileGroups)for(var r=0;r<t.tileGroups.length;r++)e.writeMessage(1,b.TileGroup.write,t.tileGroups[r])},b.TileGroup={},b.TileGroup.read=function(t,e){return t.readFields(b.TileGroup._readField,{x:0,y:0,zoom:0,tiles:[]},e)},b.TileGroup._readField=function(t,e,r){t===1?e.x=r.readVarint():t===2?e.y=r.readVarint():t===3?e.zoom=r.readVarint():t===4&&e.tiles.push(b.TileGroup.Tile.read(r,r.readVarint()+r.pos))},b.TileGroup.write=function(t,e){if(t.x&&e.writeVarintField(1,t.x),t.y&&e.writeVarintField(2,t.y),t.zoom&&e.writeVarintField(3,t.zoom),t.tiles)for(var r=0;r<t.tiles.length;r++)e.writeMessage(4,b.TileGroup.Tile.write,t.tiles[r])},b.TileGroup.Tile={},b.TileGroup.Tile.read=function(t,e){return t.readFields(b.TileGroup.Tile._readField,{regionId:0,hash:null,data:null},e)},b.TileGroup.Tile._readField=function(t,e,r){t===1?e.regionId=r.readVarint():t===2?e.hash=r.readBytes():t===3&&(e.data=r.readBytes())},b.TileGroup.Tile.write=function(t,e){t.regionId&&e.writeVarintField(1,t.regionId),t.hash&&e.writeBytesField(2,t.hash),t.data&&e.writeBytesField(3,t.data)},P();function ot(){let t=new k(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function K(){let t=new k(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function at(t,e,r){r=r*.5;let i=Math.sin(r);return t[0]=i*e[0],t[1]=i*e[1],t[2]=i*e[2],t[3]=Math.cos(r),t}function Q(t,e,r,i){let o=e[0],a=e[1],f=e[2],c=e[3],l=r[0],h=r[1],x=r[2],d=r[3],g,F,v,B,T;return F=o*l+a*h+f*x+c*d,F<0&&(F=-F,l=-l,h=-h,x=-x,d=-d),1-F>1e-6?(g=Math.acos(F),v=Math.sin(g),B=Math.sin((1-i)*g)/v,T=Math.sin(i*g)/v):(B=1-i,T=i),t[0]=B*o+T*l,t[1]=B*a+T*h,t[2]=B*f+T*x,t[3]=B*c+T*d,t}function ut(t,e){let r=e[0]+e[4]+e[8],i;if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(e[5]-e[7])*i,t[1]=(e[6]-e[2])*i,t[2]=(e[1]-e[3])*i;else{let o=0;e[4]>e[0]&&(o=1),e[8]>e[o*3+o]&&(o=2);let a=(o+1)%3,f=(o+2)%3;i=Math.sqrt(e[o*3+o]-e[a*3+a]-e[f*3+f]+1),t[o]=.5*i,i=.5/i,t[3]=(e[a*3+f]-e[f*3+a])*i,t[a]=(e[a*3+o]+e[o*3+a])*i,t[f]=(e[f*3+o]+e[o*3+f])*i}return t}const le=be;(function(){let t=P(),e=D(1,0,0),r=D(0,1,0);return function(i,o,a){let f=Te(o,a);return f<-.999999?(W(t,e,o),Ae(t)<1e-6&&W(t,r,o),Fe(t,t),at(i,t,Math.PI),i):f>.999999?(i[0]=0,i[1]=0,i[2]=0,i[3]=1,i):(W(t,o,a),i[0]=t[0],i[1]=t[1],i[2]=t[2],i[3]=1+f,le(i,i))}})(),function(){let t=K(),e=K();return function(r,i,o,a,f,c){return Q(t,i,f,c),Q(e,o,a,c),Q(r,t,e,2*c*(1-c)),r}}(),function(){let t=ot();return function(e,r,i,o){return t[0]=i[0],t[3]=i[1],t[6]=i[2],t[1]=o[0],t[4]=o[1],t[7]=o[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],le(e,ut(e,t))}}(),K();const ft=new RegExp("^(?:(?:[a-z]+:)?(?:[a-z]+:)?//|data:)","i");function he(t){return ft.test(t)}async function Z(t){const e=await self.fetch(t);if(!e.ok)throw new Error(`${e.status} ${e.statusText}: ${e.url}`);return e}const j={asset:{version:""}};async function ct(t,e){if(e){t.buffers[0].buffer=e[0]||[];return}await Promise.all(t.buffers.map(async r=>{if(r.buffer){console.error("Buffer is already loaded");return}if(!r.uri){console.error("Buffer can not be loaded. No uri");return}if(r.uri.startsWith("data:"))r.buffer=ie(r.uri);else{const i=he(r.uri)?r.uri:re(t.path)+r.uri,o=await Z(i).then(a=>a.arrayBuffer());r.buffer=o}}))}async function lt(t,e,r){if(!e.bufferView)return!1;const i=t.bufferViews[e.bufferView];if(i===void 0)return!1;await r;const o=t.buffers[i.buffer].buffer;if(!o)return!1;const a=new Uint8Array(o,i.byteOffset,i.byteLength);if(typeof createImageBitmap<"u")if(wt(a)){const f=new Blob([a],{type:e.mimeType});e.image=await createImageBitmap(f)}else return console.error(`Unsupported image type ${e.mimeType??""}`),!1;else return!1;return!0}async function ht(t,e){if(e.uri===void 0)return!1;const r=e.mimeType||Le(e.uri);if(e.mimeType=r,typeof createImageBitmap<"u"&&(r===_.JPEG||r===_.PNG))if(e.uri.startsWith("data:image")){const i=ie(e.uri);e.image=await createImageBitmap(new Blob([i],{type:r}))}else{const i=he(e.uri)?e.uri:`${re(t.path)}${e.uri}`,a=await(await Z(i)).arrayBuffer();e.image=await createImageBitmap(new Blob([a],{type:r}))}else return console.error(`Unsupported image type ${r}`),!1;return!0}async function dt(t,e){await Promise.all(t.images.map(async r=>{if(r.image){r.mimeType!==_.GLTEXTURE&&console.error("Image has already been loaded");return}await lt(t,r,e)||await ht(t,r)||console.error(`Was not able to resolve image with uri ${r.uri}`)}))}async function xt(t,e){const r=nt(t,self.origin);try{const i=await Z(r);let o=j,a;try{const f=await i.arrayBuffer();if(O.isGlb(f)){const g=new O(f).extractGlbData();o=g.json,a=g.buffers}else{const d=new TextDecoder("utf-8"),g=new Uint8Array(f);o=JSON.parse(d.decode(g))}const c=Be(o,r),l=ct(c,a),h=dt(c,l),x=tt(c,e);return await Promise.all([l,h,x]),{type:"ok",result:c}}catch(f){return{type:"error",layer:"parsing",originalError:f}}}catch(i){return{type:"error",layer:"network",originalError:i}}}function wt(t){const e=t[0]===137&&t[1]===80&&t[2]===78&&t[3]===71&&t[4]===13&&t[5]===10&&t[6]===26&&t[7]===10,r=t[0]===255&&t[1]===216&&t[2]===255;return e||r}class pt{async loadModel(e,r){return await xt(e,r)}}function yt(t){const e=new we(t),r=new pe(e);new ye(r).set("ModelsWorker",pt)}yt(self)})();
